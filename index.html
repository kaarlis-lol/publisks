<html>
    <head>
        <title>Zivs Krīt Spēle</title>
    </head>
    <body>
        <canvas id="mansZimejums" width="300" height="300" style="border:1px solid"></canvas>
        <script>
            let canvas = document.getElementById("mansZimejums");
            let ctx = canvas.getContext("2d");

            // Ielādējam attēlus
            let zivsAttels = new Image();
            zivsAttels.src = 'zivs.png';  // Šeit jānorāda attēla ceļš zivij
            let pukeAttels = new Image();
            pukeAttels.src = 'puke.png';  // Šeit jānorāda attēla ceļš puķei

            // Spēlētāja pozīcijas un izmēri
            let player_x = canvas.width / 2 - 25;
            let player_y = canvas.height - 50;
            let playerWidth = 50;
            let playerHeight = 50;

            // Zivs pozīcijas un parametri
            let zivs_x = Math.random() * (canvas.width - 20); // Zivs sākuma X pozīcija
            let zivs_y = 0; // Zivs sākuma Y pozīcija
            let zivsRadius = 20; // Zivs rādiuss

            let score = 0;
            let time_remaining = 20; // taimeris

            function MyKeyDownHandler(MyEvent) { 
                if (MyEvent.keyCode == 37 && player_x > 0) {
                    player_x -= 10; // Pārvietot pa kreisi
                }  
                if (MyEvent.keyCode == 39 && player_x + playerWidth < canvas.width) {
                    player_x += 10; // Pārvietot pa labi
                }
            }

            function Do_a_Frame() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);

                ctx.fillStyle = "purple";
                ctx.font = "20px Arial";
                ctx.fillText("Score: " + score, 10, 20);
                ctx.fillText("Time Remaining: " + Math.ceil(time_remaining), 10, 45);

                // Zīmēt puķi (spēlētāju)
                ctx.drawImage(pukeAttels, player_x, player_y, playerWidth, playerHeight); 

                // Zivs kustība
                zivs_y += 3; // Zivs krīt
                ctx.drawImage(zivsAttels, zivs_x - zivsRadius, zivs_y - zivsRadius, zivsRadius * 2, zivsRadius * 2); 

                // Pārbaudīt, vai zivs ir nokritusi
                if (zivs_y > canvas.height) {
                    zivs_y = 0; // Atjaunot zivi uz augšu
                    zivs_x = Math.random() * (canvas.width - zivsRadius * 2); // Jauna X pozīcija
                }

                // Pārbaudīt, vai spēlētājs ir noķēris zivtiņu
                if (zivs_y + zivsRadius >= player_y && zivs_x + zivsRadius > player_x && zivs_x - zivsRadius < player_x + playerWidth) {
                    score += 1; // Palielināt punktus
                    zivs_y = 0; // Atjaunot zivi uz augšu
                    zivs_x = Math.random() * (canvas.width - zivsRadius * 2); // Jauna X pozīcija
                }
            }

            // Taimeris
            function updateTimer() {
                if (time_remaining > 0) {
                    time_remaining -= 1 / 40; // Samazināt laiku (25 ms = 1/40 sekundes)
                } else {
                    clearInterval(gameInterval); // Apturēt spēli, kad laiks beidzas
                    alert("Spēle beigusies! Jūsu rezultāts: " + score);
                }
            }

            // Sākt spēles ciklu
            var gameInterval = setInterval(function() {
                Do_a_Frame();
                updateTimer();
            }, 25);

            window.addEventListener("keydown", MyKeyDownHandler); 
        </script>
    </body>
</html>
